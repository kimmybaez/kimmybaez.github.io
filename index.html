<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Оформить справку</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>  
</head>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat&display=swap');

* {
 margin: 0;
 padding: 0;
 box-sizing: border-box;
}

body {
    font-family: 'Montserrat', sans-serif;
    color: var(--tg-theme-text-color);
}

.wrapper {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
}

#form {
    margin-top: 50px;
}

#military_town {
    display: none;
}
</style>
<body>
    <div class="wrapper">
        <div id="header">
            <div class="logo">

            </div>
            <h1 class="logo_text">
                Оформить справку
            </h1>
        </div>

    <form id="form">
        <label for="type_of_certificate">Тип справки:</label>
        <select id="type_of_certificate" name="type" required>
            <option value="default">По месту требования</option>
            <option value="military">Для военкомата</option>
        </select><br><br>
        <div id="type_selected">
            <label for="surname">Фамилия:</label>
            <input type="text" id="surname" name="surname" required><br><br>

            <label for="name">Имя:</label>
            <input type="text" id="name" name="name" required><br><br>

            <label for="middle_name">Отчество:</label>
            <input type="text" id="middle_name" name="middle_name" required><br><br>

            <label for="dob">Дата рождения:</label>
            <input type="date" id="dob" name="birthday_date" required><br><br>
        </div>
        <div id="second_stage">
            <label for="course">Курс:</label>
            <select id="course" name="course" required>
                <option value="1 курса">1 курс</option>
                <option value="2 курса">2 курс</option>
                <option value="3 курса">3 курс</option>
                <option value="4 курса">4 курс</option>
            </select><br><br>

            <label for="form">Форма обучения:</label>
            <select id="form" name="form" required>
                <option value="Бюджет">Бюджет</option>
                <option value="Внебюджет">Внебюджет</option>
            </select><br><br>
        </div>
        <div id="military_town">
            <label for="military_office_town">Город военкомата:</label>
            <input type="text" id="military_office_town" name="military_office_town"><br><br>
        </div>
    </form>
    </div>
    <script>
        let tg = window.Telgram.WebApp;

        tg.MainButton.text = "Отправить на оформление";
        tg.MainButton.color = "#169CD8";
        tg.MainButton.show();
        tg.expand()

        const selectElement = document.getElementById('type_of_certificate');
        const militaryTownElement = document.getElementById('military_town');
        let type = selectElement.value;
        let surname = document.getElementById("surname").value;
        let name = document.getElementById("name").value;
        let middle_name = document.getElementById("middle_name").value;
        let dob = document.getElementById("dob").value;
        let course = document.getElementById("course").value;
        let form = document.getElementById("form").value;
        let military_town = document.getElementById("military_office_town").value;

        selectElement.addEventListener('change', function() {
            if (selectElement.value === 'military') {
                militaryTownElement.style.display = "block";
            } else {
                militaryTownElement.style.display = "none";
            }
        });
        Telegram.WebApp.onEvent('mainButtonClicked', function(){
            let user_data = {
                    type: type,
                    surname: surname,
                    name: name,
                    middle_name: middle_name,
                    birthday_date: dob,
                    course: course,
                    form: form,
                    military_town: military_town
                }
            tg.sendData(JSON.stringify(user_data));
            tg.close();
        });
    </script>
</body>
</html>